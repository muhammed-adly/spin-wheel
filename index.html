<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Spin the Wheel Game</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">
  <style>
    body {
      text-align: center;
      font-family: 'Montserrat', sans-serif;
      background: #f0f0f5;
      color: #333;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin-top: 20px;
      font-size: 2.5em;
      color: #007BFF;
    }
    h2 {
      color: #007BFF;
    }
    /* Container for the wheel and pointer */
    #wheelContainer {
      position: relative;
      display: inline-block;
      margin-top: 40px;
    }
    #wheelCanvas {
      /* Remove square border; add a subtle shadow and round it */
      border: none;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      border-radius: 50%;
    }
    /* Pointer placed above the wheel and pointing down */
    #pointer {
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 30px solid #333; /* Triangle pointing down */
      position: absolute;
      top: -30px; /* Placed above the canvas */
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }
    #controls {
      margin-top: 20px;
    }
    input[type="text"] {
      width: 400px;
      font-size: 16px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      outline: none;
      margin-top: 10px;
      transition: border-color 0.3s;
    }
    input[type="text"]:focus {
      border-color: #007BFF;
    }
    button {
      font-size: 16px;
      padding: 10px 20px;
      margin: 10px;
      cursor: pointer;
      background: linear-gradient(45deg, #007BFF, #00C6FF);
      border: none;
      border-radius: 25px;
      color: #fff;
      transition: background 0.3s, transform 0.2s;
    }
    button:hover {
      background: linear-gradient(45deg, #0056b3, #0098cc);
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <h1>Spin the Wheel Game</h1>
  
  <!-- Control for updating wheel segments in real time -->
  <div id="controls">
    <label for="namesInput">Enter comma separated names:</label><br>
    <input type="text" id="namesInput" placeholder="Name1, Name2, Name3, ...">
  </div>
  
  <div id="wheelContainer">
    <div id="pointer"></div>
    <canvas id="wheelCanvas" width="500" height="500"></canvas>
  </div>
  
  <br>
  <button id="spinButton">Spin!</button>
  <h2 id="result"></h2>
  
  <script>
    var canvas = document.getElementById("wheelCanvas");
    var ctx = canvas.getContext("2d");

    // Default segments if no names are provided
    var defaultSegments = ["Prize 1", "Prize 2", "Prize 3", "Prize 4", "Prize 5", "Prize 6", "Prize 7", "Prize 8"];
    var segments = defaultSegments.slice();
    
    // Generate vibrant colors based on the number of segments
    var colors = generateColors(segments.length);
    
    var startAngle = 0;
    var arc = Math.PI * 2 / segments.length; 
    var spinTime = 0;
    var spinTimeTotal = 0;
    var spinAngleTotal = 0;
    
    function generateColors(n) {
      var colors = [];
      for (var i = 0; i < n; i++) {
        var hue = Math.floor(360 * i / n);
        // Using 80% saturation for vibrant colors
        colors.push("hsl(" + hue + ", 80%, 60%)");
      }
      return colors;
    }
    
    function drawWheel() {
      var outsideRadius = 200;
      var textRadius = 160;
      var insideRadius = 50;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.strokeStyle = "white";
      ctx.lineWidth = 2;
      ctx.font = "bold 16px 'Montserrat', sans-serif";
      
      // Update arc based on current segments count
      arc = Math.PI * 2 / segments.length;
      
      for (var i = 0; i < segments.length; i++) {
        var angle = startAngle + i * arc;
        ctx.fillStyle = colors[i];
        ctx.beginPath();
        ctx.arc(250, 250, outsideRadius, angle, angle + arc, false);
        ctx.arc(250, 250, insideRadius, angle + arc, angle, true);
        ctx.fill();
        ctx.stroke();
        
        // Draw the segment text
        ctx.save();
        ctx.fillStyle = "#fff";
        ctx.translate(250 + Math.cos(angle + arc/2) * textRadius, 250 + Math.sin(angle + arc/2) * textRadius);
        ctx.rotate(angle + arc/2 + Math.PI/2);
        var text = segments[i];
        ctx.fillText(text, -ctx.measureText(text).width / 2, 0);
        ctx.restore();
      }
    }
    
    function rotateWheel() {
      spinTime += 30;
      if (spinTime >= spinTimeTotal) {
        stopRotateWheel();
        return;
      }
      // Ease-out effect for smooth deceleration
      var spinAngle = easeOut(spinTime, 0, spinAngleTotal, spinTimeTotal);
      startAngle += (spinAngle * Math.PI / 180);
      drawWheel();
      requestAnimationFrame(rotateWheel);
    }
    
    function stopRotateWheel() {
      // For a pointer above the wheel (pointing down), add 90 degrees
      var degrees = startAngle * 180 / Math.PI + 90;
      var arcd = arc * 180 / Math.PI;
      var index = Math.floor((360 - degrees % 360) / arcd);
      document.getElementById("result").innerHTML = "Result: " + segments[index];
    }
    
    // Ease-out function for smooth deceleration
    function easeOut(t, b, c, d) {
      t /= d;
      var ts = t * t;
      var tc = ts * t;
      return b + c * (tc - 3 * ts + 3 * t);
    }
    
    // Spin button event listener
    document.getElementById("spinButton").addEventListener("click", function() {
      spinTime = 0;
      // Increase total spin time (6-9 seconds) for a slower, realistic spin
      spinTimeTotal = Math.random() * 3000 + 6000;
      spinAngleTotal = Math.random() * 1000 + 1500;
      rotateWheel();
    });
    
    // Real-time update of wheel segments from textbox input
    document.getElementById("namesInput").addEventListener("input", function() {
      var input = this.value;
      // If there's any input, update segments; otherwise revert to default segments
      if (input.trim() !== "") {
        segments = input.split(",").map(function(name) {
          return name.trim();
        }).filter(function(name) {
          return name !== "";
        });
      } else {
        segments = defaultSegments.slice();
      }
      colors = generateColors(segments.length);
      // Reset starting angle so changes are immediately visible
      startAngle = 0;
      drawWheel();
    });
    
    // Draw the initial wheel
    drawWheel();
  </script>
</body>
</html>
